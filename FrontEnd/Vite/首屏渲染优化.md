Vite 首屏优化 = **“让浏览器少拿、早拿、并行拿最关键的资源”**。下面把社区实战（10 s → 1.5 s） 和官方最佳实践浓缩成一份「拿来即用」的 Checklist，按 ROI 从高到低排序，并给出可复制粘贴的代码片段。

---
### ✅ 1. 先定位：到底慢在哪

| 工具                           | 命令 / 用法                                                                                 | 看啥            |
| :--------------------------- | :-------------------------------------------------------------------------------------- | :------------ |
| **rollup-plugin-visualizer** | `pnpm i -D rollup-plugin-visualizer` 并在 `vite.config.ts` 里加 `visualizer({ open:true })` | 找出胖 chunk     |
| **Chrome Coverage**          | F12 → Ctrl+Shift+P → Show Coverage → 刷新                                                 | 红色 = 首屏用不到的代码 |

---
### ✅ 2. 资源体积瘦身（一次性砍掉 80% 非首屏代码）


```ts
// vite.config.ts
export default defineConfig({
  build: {
    rollupOptions: {
      output: {
        // 1️⃣ 第三方库单独 chunk，浏览器可长期缓存
        manualChunks(id) {
          if (id.includes('node_modules')) return 'vendor';
        }
      }
    },
    // 2️⃣ 启用 CSS 代码分割
    cssCodeSplit: true
  },
  plugins: [
    // 3️⃣ 组件 & 图标按需
    Components({ resolvers: [AntDesignVueResolver()] }),
    // 4️⃣ 生产压缩 brotli/gzip
    compression({ algorithm: 'brotliCompress' })
  ]
})
```

---
### ✅ 3. 关键渲染路径优化（首屏只加载 < 200 KB）

| 手段                 | 实操代码                                                      | 收益            |
| :----------------- | :-------------------------------------------------------- | :------------ |
| **路由级懒加载**         | `const Home = () => import('@/pages/Home.vue')`           | 主包瞬间降 50%     |
| **大组件再拆**          | `const Chart = React.lazy(() => import('./EchartsWrap'))` | 图表不在首屏就不加载    |
| **字体延迟**           | `@font-face{font-display:swap;}`                          | 先渲染系统字体，再异步替换 |
| **图片走 CDN + WebP** | `<img loading="lazy" src="https://cdn.xxx.com/a.webp" />` | 首屏省掉 70% 图片体积 |

---
### ✅ 4. 网络层加速（把「下载」这一步压到 1 s 内）

1. **HTTP/2 + CDN**：把 `dist/assets/**` 推到七牛/阿里 CDN，并开 Brotli。
2. **preload / prefetch
    
    ```html
    <link rel="preload" href="/vendor.brotli.js" as="script" crossorigin />
    <link rel="prefetch" href="/admin.chunk.js" as="script" />
    ```
    
3. **缓存策略**
    
    - 文件名带 hash → 强缓存一年
    - `index.html` 设置 `Cache-Control: no-cache` 方便发版

---
### ✅ 5. 骨架屏让“感知更快”（可选）

使用 [vite-plugin-skeleton](https://github.com/jackieku/vue-skeleton-webpack-plugin) 或自己写插件，在 `transformIndexHtml` 把骨架 HTML 直接注入 `<div id="app">` 内，首屏瞬间出现「灰块」。

---
### ✅ 6. 开发环境也快（10 s → 2 s）

- **依赖预构建缓存**：`vite --force` 只在升级依赖后执行一次。
- **按需编译**：Vite 本身就是访问路由时才编译对应文件，无需额外配置。

---
### 📊 真实优化结果（社区案例）

|指标|优化前|优化后|
|:--|:--|:--|
|主包 JS|41 MB|6.7 MB|
|首屏 LCP|10.47 s|1.53 s|
|资源峰值|5 s|0.9 s|

---

### 一键启动模板

```bash
git clone https://github.com/originjs/vite-templates/tree/master/packages/vue3
# 已集成 visualizer + compression + auto-import + lazy routes
```

照抄完上面 6 步，**首屏基本都能压进 2 s 以内**。如还有具体瓶颈（如大 JSON、3D 模型等），把 Network 面板贴出来，我再帮你针对性拆解。